<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NM Timer</title>
	<link rel="stylesheet" href="styles.css" />
    <!--
	table {
      border-collapse: collapse;
      width: 70%;
      margin-top: 20px;
      font-family: Arial, sans-serif;
    }
    th, td {
      border: 1px solid #555;
      padding: 8px 12px;
      text-align: left;
    }
    th {
      background-color: #ddd;
    }
	-->
</head>
<body>
	<header class="page-header"> 
		<h2>NM Respawn Timer</h2>
	</header>
	<main>
		  <div class="div-container">
		  <div class="div-left">
			<h4> Mob1 </h4>
		  <label>
			ToD (HH:MM:SS):
			<input id="tod" value="05:23:38">
		  </label>
		  <br>

		  <label>
			Offset (MM:SS):
			<input id="offset" value="07:05">
		  </label>
		  <br><br>

		  <button onclick="startTimer()">Start Timer</button>

		  <h3 id="targetDisplay"></h3>
		  <p id="statusDisplay"></p>
		  </div>
		 <div class="div-right"> 
		  <h4> Mob2 </h4>
		  <label>
			ToD (HH:MM:SS):
			<input id="tod2" value="05:23:38">
		  </label>
		  <br>

		  <label>
			Offset (MM:SS):   
			<input id="offset2" value="05:35">
		  </label>
		  <br><br>

		  <button onclick="startTimer2()">Start Timer</button>

		  <h3 id="targetDisplay2"></h3>
		  <p id="statusDisplay2"></p>
		 </div> 
		 </div>
		 <div class="page-header">
		  <h2>NM Respawn Reference Lookup</h2>
			<section class="table-section">
            <div class="table-wrapper">
				<table>
					<thead>
					  <tr>
						<th>NM</th>
						<th>Respawn Window Open</th>
						<th>Placeholder Mob</th>
						<th>Placeholder ID(s)</th>
						<th>Offset 1</th>
						<th>Offset 2</th>
					  </tr>
					</thead>
					<thead>
					  <tr>
						<td>Demonic Tiphia</td>
						<td>02:00</td>
						<td>Wespe</td>
						<td>10C</td>
						<td>7:05</td>
						<td></td>
					  </tr>
					</thead>
				</table>
			</div>
		</section>
		</div>
	</main>
	<footer class="page-footer">
        <p>Drop this <code>index.html</code> in the same folder as <code>styles.css</code> and open it in your browser.</p>
		<p>Lee Lightfoot<sup>&trade;</sup></p>
    </footer>
  <script>
    function startTimer() {
      const todStr = document.getElementById('tod').value.trim();
      const offsetStr = document.getElementById('offset').value.trim();

      const [todH, todM, todS] = todStr.split(':').map(Number);
      const [offM, offS] = offsetStr.split(':').map(Number);

      const now = new Date();
      let target = new Date(
        now.getFullYear(), now.getMonth(), now.getDate(),
        todH, todM, todS
      );
      target = new Date(target.getTime() + (offM * 60 + offS) * 1000);

      if (target < now) {
        target.setDate(target.getDate() + 1);
      }

      const targetTimeStr = target.toTimeString().split(' ')[0];
      document.getElementById('targetDisplay').textContent =
        "Expected pop time: " + targetTimeStr;
      document.getElementById('statusDisplay').textContent = "Timer running...";

      const timer = setInterval(() => {
        const current = new Date();
        if (current >= target) {
          clearInterval(timer);
          document.getElementById('statusDisplay').textContent = "POP TIME!";
          const audio = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
          audio.play();
        }
      }, 1000);
    }
	function startTimer2() {
      const todStr = document.getElementById('tod2').value.trim();
      const offsetStr = document.getElementById('offset2').value.trim();

      const [todH, todM, todS] = todStr.split(':').map(Number);
      const [offM, offS] = offsetStr.split(':').map(Number);

      const now = new Date();
      let target = new Date(
        now.getFullYear(), now.getMonth(), now.getDate(),
        todH, todM, todS
      );
      target = new Date(target.getTime() + (offM * 60 + offS) * 1000);

      if (target < now) {
        target.setDate(target.getDate() + 1);
      }

      const targetTimeStr = target.toTimeString().split(' ')[0];
      document.getElementById('targetDisplay2').textContent =
        "Expected pop time: " + targetTimeStr;
      document.getElementById('statusDisplay2').textContent = "Timer running...";

      const timer = setInterval(() => {
        const current = new Date();
        if (current >= target) {
          clearInterval(timer);
          document.getElementById('statusDisplay2').textContent = "POP TIME!";
          const audio = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
          audio.play();
        }
      }, 1000);
    }
  </script>
</body>
</html>
